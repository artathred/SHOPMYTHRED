{"ast":null,"code":"import { PLATFORM_ID } from '@angular/core';\nimport { Template } from '../models/template.model';\nimport { Product } from '../models/product.model';\nimport { Globals } from '../globals';\nimport { isPlatformBrowser } from '@angular/common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/platform-browser\";\nimport * as i3 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i4 from \"ngx-spinner\";\nimport * as i5 from \"@angular/common\";\n\nfunction ModelViewerComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 4);\n    i0.ɵɵelementStart(1, \"ngx-spinner\", 5);\n    i0.ɵɵelementStart(2, \"h2\", 6);\n    i0.ɵɵtext(3, \"Launching Model Viewer...\\n\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵstyleProp(\"color\", ctx_r0.selectedIndicator().color);\n    i0.ɵɵpropertyInterpolate(\"bdColor\", ctx_r0.selectedIndicator().bg_color);\n    i0.ɵɵpropertyInterpolate(\"color\", ctx_r0.selectedIndicator().color);\n    i0.ɵɵpropertyInterpolate(\"type\", ctx_r0.selectedIndicator().name);\n    i0.ɵɵproperty(\"fullScreen\", false)(\"disableAnimation\", true);\n  }\n}\n\nexport let ModelViewerComponent = /*#__PURE__*/(() => {\n  class ModelViewerComponent {\n    constructor(http, sanitizer, modalService, platformID, spinner) {\n      this.http = http;\n      this.sanitizer = sanitizer;\n      this.modalService = modalService;\n      this.platformID = platformID;\n      this.spinner = spinner;\n      this.myHtmlTemplate = '';\n      this.data = {\n        \"template\": new Template(),\n        \"product\": new Product()\n      };\n      this.template = new Template();\n      this.product = new Product();\n      this.isSpinning = false;\n    }\n\n    ngAfterViewInit() {}\n\n    ngOnInit() {\n      this.template = this.data.template;\n      this.product = this.data.product;\n      this.showSpinner();\n      this.openModel();\n    }\n\n    getModelUrl(type) {\n      switch (type) {\n        case \"ATC Hoodie\":\n          return \"https://firebasestorage.googleapis.com/v0/b/clothingapp-ed125.appspot.com/o/Models%2FHoodies%2Fhoodie_model.glb?alt=media\";\n\n        case \"MUG\":\n          return \"https://firebasestorage.googleapis.com/v0/b/clothingapp-ed125.appspot.com/o/Models%2FMugs%2Fmug_model2.glb?alt=media\";\n\n        default:\n          return \"https://firebasestorage.googleapis.com/v0/b/clothingapp-ed125.appspot.com/o/Models%2FTShirts%2Fshirt_model.glb?alt=media\";\n      }\n    }\n\n    getModelTextureUrl(type, templateColor) {\n      switch (type) {\n        case \"ATC Hoodie\":\n          return \"https://firebasestorage.googleapis.com/v0/b/clothingapp-ed125.appspot.com/o/Models%2FHoodies%2FTextures%2F\" + templateColor + \".jpg?alt=media\";\n\n        case \"MUG\":\n          return \"https://firebasestorage.googleapis.com/v0/b/clothingapp-ed125.appspot.com/o/Models%2FMugs%2FTextures%2F\" + templateColor + \".jpg?alt=media\";\n\n        default:\n          return \"https://firebasestorage.googleapis.com/v0/b/clothingapp-ed125.appspot.com/o/Models%2FTShirts%2FTextures%2F\" + templateColor + \".jpg?alt=media\";\n      }\n    }\n\n    getSkyBoxUrl(type, skyBoxCode) {\n      var productType = \"TShirts\";\n\n      switch (type) {\n        case \"ATC Hoodie\":\n          productType = \"Hoodies\";\n          break;\n\n        case \"MUG\":\n          productType = \"Mugs\";\n          break;\n\n        default:\n          productType = \"TShirts\";\n      }\n\n      return \"https://storage.googleapis.com/clothingapp-ed125.appspot.com/Models/\" + productType + \"/Skyboxes/\" + skyBoxCode + \".hdr\";\n    }\n\n    openBtn() {\n      console.log(\"ok\");\n      this.modalService.dismissAll(\"success\");\n    }\n\n    isBrowser() {\n      return isPlatformBrowser(this.platformID);\n    }\n\n    selectedIndicator() {\n      var _a, _b, _c, _d, _e, _f;\n\n      let co = (_b = (_a = Globals.storeInfo) === null || _a === void 0 ? void 0 : _a.loading) === null || _b === void 0 ? void 0 : _b.color;\n      let bco = (_d = (_c = Globals.storeInfo) === null || _c === void 0 ? void 0 : _c.loading) === null || _d === void 0 ? void 0 : _d.bg_color;\n      let name = (_f = (_e = Globals.storeInfo) === null || _e === void 0 ? void 0 : _e.loading) === null || _f === void 0 ? void 0 : _f.name;\n      let color = \"rgba(\" + co[0] + \",\" + co[1] + \",\" + co[2] + \",\" + co[3] + \")\";\n      let bg_color = \"rgba(\" + bco[0] + \",\" + bco[1] + \",\" + bco[2] + \",\" + bco[3] + \")\";\n      let indicator = {\n        \"name\": name,\n        \"color\": color,\n        \"bg_color\": bg_color\n      };\n      return indicator;\n    }\n\n    selectedTheme() {\n      var _a, _b, _c, _d, _e, _f;\n\n      let co = (_b = (_a = Globals.storeInfo) === null || _a === void 0 ? void 0 : _a.colorStyle) === null || _b === void 0 ? void 0 : _b.btn_color;\n      let bco = (_d = (_c = Globals.storeInfo) === null || _c === void 0 ? void 0 : _c.colorStyle) === null || _d === void 0 ? void 0 : _d.bg_color;\n      let name = (_f = (_e = Globals.storeInfo) === null || _e === void 0 ? void 0 : _e.colorStyle) === null || _f === void 0 ? void 0 : _f.name;\n      let color = \"rgba(\" + co[0] + \",\" + co[1] + \",\" + co[2] + \",\" + co[3] + \")\";\n      let bg_color = \"rgba(\" + bco[0] + \",\" + bco[1] + \",\" + bco[2] + \",\" + bco[3] + \")\";\n      var theme = {\n        \"name\": name,\n        \"color\": color,\n        \"bg_color\": bg_color\n      };\n      return theme;\n    }\n\n    showSpinner() {\n      if (!this.isSpinning) {\n        this.isSpinning = true;\n\n        if (isPlatformBrowser(this.platformID)) {\n          this.spinner.show();\n        }\n\n        ;\n        setTimeout(() => {\n          if (isPlatformBrowser(this.platformID)) {\n            this.hideSpinner();\n            this.spinner.hide();\n          }\n\n          ;\n        }, 2000);\n      }\n    }\n\n    hideSpinner() {\n      if (this.isSpinning) {\n        this.isSpinning = false; // this.spinner.hide()\n      }\n    }\n\n    openModel() {\n      var _a, _b, _c;\n\n      var html = \"\";\n      var skyBoxUrl = this.getSkyBoxUrl(this.product.productType, \"room\");\n      var modelTextureURL = this.getModelTextureUrl(this.product.productType, this.product.templateColor);\n      var modelURL = this.getModelUrl(this.product.productType);\n      let backURL = (_a = this.product.getUrl(true)) !== null && _a !== void 0 ? _a : \"\";\n      let url = (_b = this.product.getUrl(false)) !== null && _b !== void 0 ? _b : \"\";\n      let color = this.template.colors.find(color => color.code == this.product.templateColor);\n\n      if (color) {\n        var colors = [1, 1, 1, 1];\n        color.rgb.forEach((e, index) => {\n          colors[index] = e;\n        });\n\n        switch ((_c = this.template.productCode) !== null && _c !== void 0 ? _c : \"ATC1000\") {\n          case \"ATC1000\":\n            html = \"<!doctype html><html lang='en'><head></head><title>&lt;model-viewer&gt; template</title><meta charset='utf-8'><meta name='description' content='&lt;model-viewer&gt; template'><meta name='viewport' content='width=device-width, initial-scale=1'><script src='https://unpkg.com/focus-visible@5.0.2/dist/focus-visible.js' defer></script></head><body><model-viewer camera-controls skybox-image='\" + skyBoxUrl + \"'environment-image='\" + skyBoxUrl + \"'alt='A 3D astronaut model depicted within a forest'src='\" + modelURL + \"'></model-viewer><script type='module'>const onProgress = (event) => {if (event.detail.totalProgress === 1) {const modelViewerColor = document.querySelector('model-viewer');modelViewerColor.environmentImage = 'neutral';const materials = modelViewerColor.model.materials;for (let i = 0; i < materials.length; i++) {if (i === 0){let material = modelViewerColor.model.materials[i];material.pbrMetallicRoughness.baseColorTexture.texture.source.setURI('\" + modelTextureURL + \"');}else if (i === 1){let material = modelViewerColor.model.materials[i];material.pbrMetallicRoughness.baseColorTexture.texture.source.setURI('\" + url + \"');}console.log(materials[i])}}};document.querySelector('model-viewer').addEventListener('progress', onProgress);</script><script type='module' src='https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js'></script><style>:not(:defined) > * {display: none;}body {margin: 0;padding: 0;width: 100vw;height: 100vh;}model-viewer {width: 100%;height: 100%;background-color: #baf7fd;display: flex;justify-content: center;align-items: center;}.progress-bar {display: block;width: 33%;height: 10%;max-height: 2%;position: absolute;left: 50%;top: 50%;transform: translate3d(-50%, -50%, 0);border-radius: 25px;box-shadow: 0px 3px 10px 3px #baf7fd, 0px 0px 5px 1px #baf7fd;border: 1px solid #baf7fd;}.progress-bar.hide {visibility: hidden;transition: visibility 0.3s;}.update-bar {background-color: #baf7fd;width: 0%;height: 100%;border-radius: 25px;float: left;transition: width 0.3s;}#ar-button {background-image: url(ar_icon.png);background-repeat: no-repeat;background-size: 20px 20px;background-position: 12px 50%;background-color: #baf7fd;position: absolute;left: 50%;transform: translateX(-50%);white-space: nowrap;bottom: 132px;padding: 0px 16px 0px 40px;font-family: Roboto Regular, Helvetica Neue, sans-serif;font-size: 14px;color:#baf7fd;height: 36px;line-height: 36px;border-radius: 18px;border: 1px solid #baf7fd;}#ar-button:active {background-color: #baf7fd;}#ar-button:focus {outline: none;}#ar-button:focus-visible {outline: 1px solid #baf7fd;}@keyframes circle {from { transform: translateX(-50%) rotate(0deg) translateX(50px) rotate(0deg); }to   { transform: translateX(-50%) rotate(360deg) translateX(50px) rotate(-360deg); }}@keyframes elongate {from { transform: translateX(100px); }to   { transform: translateX(-100px); }}model-viewer > #ar-prompt {position: absolute;left: 50%;bottom: 175px;animation: elongate 2s infinite ease-in-out alternate;display: none;}model-viewer[ar-status='session-started'] > #ar-prompt {display: block;}model-viewer > #ar-prompt > img {animation: circle 4s linear infinite;}</style></body></html>\";\n            break;\n\n          case \"ATC Hoodie\":\n            html = \"<!doctype html><html lang='en'><head></head><title>&lt;model-viewer&gt; template</title><meta charset='utf-8'><meta name='description' content='&lt;model-viewer&gt; template'><meta name='viewport' content='width=device-width, initial-scale=1'><script src='https://unpkg.com/focus-visible@5.0.2/dist/focus-visible.js' defer></script></head><body><model-viewer camera-controls skybox-image='\" + skyBoxUrl + \"'environment-image='\" + skyBoxUrl + \"'alt='A 3D astronaut model depicted within a forest'src='\" + modelURL + \"'></model-viewer><script type='module'>const onProgress = (event) => {if (event.detail.totalProgress === 1) {const modelViewerColor = document.querySelector('model-viewer');modelViewerColor.environmentImage = 'neutral';const materials = modelViewerColor.model.materials;for (let i = 0; i < materials.length; i++) {if (materials[i].name === 'Left Cap' || materials[i].name === 'Right Cap' || materials[i].name == 'String Holes (Interior)'){materials[i].pbrMetallicRoughness.setBaseColorFactor([\" + colors[0] + \", \" + colors[1] + \", \" + colors[2] + \", \" + colors[3] + \"]);}else if (materials[i].name === 'String Holes'){materials[i].pbrMetallicRoughness.setBaseColorFactor([0.7,0.7,0.7,1]);}else if (materials[i].name === 'Draw Strings' || materials[i].name === 'Body' || materials[i].name == 'Front Canvas'){materials[i].pbrMetallicRoughness.baseColorTexture.texture.source.setURI('\" + modelTextureURL + \"');}else if (materials[i].name === 'Front Image'){console.log(materials[i]);materials[i].pbrMetallicRoughness.baseColorTexture.texture.source.setURI('\" + url + \"');}else if (materials[i].name === 'Back Image'){materials[i].pbrMetallicRoughness.baseColorTexture.texture.source.setURI('\" + backURL + \"');}console.log(materials[i].name)}}};document.querySelector('model-viewer').addEventListener('progress', onProgress);</script><script type='module' src='https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js'></script><style>:not(:defined) > * {display: none;}body {margin: 0;padding: 0;width: 100vw;height: 100vh;}model-viewer {width: 100%;height: 100%;background-color: #baf7fd;display: flex;justify-content: center;align-items: center;}.progress-bar {display: block;width: 33%;height: 10%;max-height: 2%;position: absolute;left: 50%;top: 50%;transform: translate3d(-50%, -50%, 0);border-radius: 25px;box-shadow: 0px 3px 10px 3px #baf7fd, 0px 0px 5px 1px #baf7fd;border: 1px solid #baf7fd;}.progress-bar.hide {visibility: hidden;transition: visibility 0.3s;}.update-bar {background-color: #baf7fd;width: 0%;height: 100%;border-radius: 25px;float: left;transition: width 0.3s;}#ar-button {background-image: url(ar_icon.png);background-repeat: no-repeat;background-size: 20px 20px;background-position: 12px 50%;background-color: #baf7fd;position: absolute;left: 50%;transform: translateX(-50%);white-space: nowrap;bottom: 132px;padding: 0px 16px 0px 40px;font-family: Roboto Regular, Helvetica Neue, sans-serif;font-size: 14px;color:#baf7fd;height: 36px;line-height: 36px;border-radius: 18px;border: 1px solid #baf7fd;}#ar-button:active {background-color: #baf7fd;}#ar-button:focus {outline: none;}#ar-button:focus-visible {outline: 1px solid #baf7fd;}@keyframes circle {from { transform: translateX(-50%) rotate(0deg) translateX(50px) rotate(0deg); }to   { transform: translateX(-50%) rotate(360deg) translateX(50px) rotate(-360deg); }}@keyframes elongate {from { transform: translateX(100px); }to   { transform: translateX(-100px); }}model-viewer > #ar-prompt {position: absolute;left: 50%;bottom: 175px;animation: elongate 2s infinite ease-in-out alternate;display: none;}model-viewer[ar-status='session-started'] > #ar-prompt {display: block;}model-viewer > #ar-prompt > img {animation: circle 4s linear infinite;}</style></body></html>\";\n            break;\n\n          case \"MUG\":\n            html = \"<!doctype html><html lang='en'><head></head><title>&lt;model-viewer&gt; template</title><meta charset='utf-8'><meta name='description' content='&lt;model-viewer&gt; template'><meta name='viewport' content='width=device-width, initial-scale=1'><script src='https://unpkg.com/focus-visible@5.0.2/dist/focus-visible.js' defer></script></head><body><model-viewer camera-controls skybox-image='\" + skyBoxUrl + \"'environment-image='\" + skyBoxUrl + \"'alt='A 3D astronaut model depicted within a forest'src='\" + modelURL + \"'></model-viewer><script type='module'>const onProgress = (event) => {if (event.detail.totalProgress === 1) {const modelViewerColor = document.querySelector('model-viewer');modelViewerColor.environmentImage = 'neutral';const materials = modelViewerColor.model.materials;for (let i = 0; i < materials.length; i++) {if (materials[i].name == 'DefaultMaterial.001'){materials[i].pbrMetallicRoughness.baseColorTexture.texture.source.setURI('');materials[i].pbrMetallicRoughness.baseColorTexture.texture.source.setURI('\" + modelTextureURL + \"');}else if (materials[i].name == 'Design'){let material = modelViewerColor.model.materials[i];material.pbrMetallicRoughness.baseColorTexture.texture.source.setURI('\" + url + \"');}else if (materials[i].name == 'Design_Back'){let material = modelViewerColor.model.materials[i];material.pbrMetallicRoughness.baseColorTexture.texture.source.setURI('\" + backURL + \"');}console.log(materials[i])}}};document.querySelector('model-viewer').addEventListener('progress', onProgress);</script><script type='module' src='https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js'></script><style>:not(:defined) > * {display: none;}body {margin: 0;padding: 0;width: 100vw;height: 100vh;}model-viewer {width: 100%;height: 100%;background-color: #baf7fd;display: flex;justify-content: center;align-items: center;}.progress-bar {display: block;width: 33%;height: 10%;max-height: 2%;position: absolute;left: 50%;top: 50%;transform: translate3d(-50%, -50%, 0);border-radius: 25px;box-shadow: 0px 3px 10px 3px #baf7fd, 0px 0px 5px 1px #baf7fd;border: 1px solid #baf7fd;}.progress-bar.hide {visibility: hidden;transition: visibility 0.3s;}.update-bar {background-color: #baf7fd;width: 0%;height: 100%;border-radius: 25px;float: left;transition: width 0.3s;}#ar-button {background-image: url(ar_icon.png);background-repeat: no-repeat;background-size: 20px 20px;background-position: 12px 50%;background-color: #baf7fd;position: absolute;left: 50%;transform: translateX(-50%);white-space: nowrap;bottom: 132px;padding: 0px 16px 0px 40px;font-family: Roboto Regular, Helvetica Neue, sans-serif;font-size: 14px;color:#baf7fd;height: 36px;line-height: 36px;border-radius: 18px;border: 1px solid #baf7fd;}#ar-button:active {background-color: #baf7fd;}#ar-button:focus {outline: none;}#ar-button:focus-visible {outline: 1px solid #baf7fd;}@keyframes circle {from { transform: translateX(-50%) rotate(0deg) translateX(50px) rotate(0deg); }to   { transform: translateX(-50%) rotate(360deg) translateX(50px) rotate(-360deg); }}@keyframes elongate {from { transform: translateX(100px); }to   { transform: translateX(-100px); }}model-viewer > #ar-prompt {position: absolute;left: 50%;bottom: 175px;animation: elongate 2s infinite ease-in-out alternate;display: none;}model-viewer[ar-status='session-started'] > #ar-prompt {display: block;}model-viewer > #ar-prompt > img {animation: circle 4s linear infinite;}</style></body></html>\";\n            break;\n\n          default:\n            html = \"\";\n            return;\n        }\n\n        this.myHtmlTemplate = this.sanitizer.bypassSecurityTrustHtml(html);\n      }\n    }\n\n  }\n\n  ModelViewerComponent.ɵfac = function ModelViewerComponent_Factory(t) {\n    return new (t || ModelViewerComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.DomSanitizer), i0.ɵɵdirectiveInject(i3.NgbModal), i0.ɵɵdirectiveInject(PLATFORM_ID), i0.ɵɵdirectiveInject(i4.NgxSpinnerService));\n  };\n\n  ModelViewerComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ModelViewerComponent,\n    selectors: [[\"app-model-viewer\"]],\n    decls: 5,\n    vars: 2,\n    consts: [[1, \"card-body\", \"p-0\", \"pb-0\"], [\"type\", \"submit\", 1, \"btn\", 2, \"width\", \"100%\", \"height\", \"7.5%\", \"display\", \"block\", \"border\", \"none\", \"font-weight\", \"bold\", \"cursor\", \"pointer\", 3, \"click\"], [2, \"z-index\", \"1\", \"position\", \"absolute\", \"border\", \"0\", \"width\", \"100%\", \"height\", \"600px\", \"overflow\", \"auto\", 3, \"srcdoc\"], [\"style\", \"z-index: 2; position: absolute; border: 0; width:100%; height: 600px; overflow: auto;\", 4, \"ngIf\"], [2, \"z-index\", \"2\", \"position\", \"absolute\", \"border\", \"0\", \"width\", \"100%\", \"height\", \"600px\", \"overflow\", \"auto\"], [\"size\", \"medium\", 3, \"bdColor\", \"color\", \"type\", \"fullScreen\", \"disableAnimation\"], [1, \"mt-5\"]],\n    template: function ModelViewerComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"button\", 1);\n        i0.ɵɵlistener(\"click\", function ModelViewerComponent_Template_button_click_1_listener() {\n          return ctx.openBtn();\n        });\n        i0.ɵɵtext(2, \" CLOSE \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(3, \"iframe\", 2);\n        i0.ɵɵtemplate(4, ModelViewerComponent_div_4_Template, 4, 8, \"div\", 3);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"srcdoc\", ctx.myHtmlTemplate, i0.ɵɵsanitizeHtml);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isSpinning);\n      }\n    },\n    directives: [i5.NgIf, i4.NgxSpinnerComponent],\n    styles: [\"\"]\n  });\n  return ModelViewerComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}